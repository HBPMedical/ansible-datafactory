#! /bin/bash


db_mipmap={{ mipmap_db }}
db_capture={{ capture_db }}
db_harmonized={{ harmonize_db }}
container_name={{ postgresql_container }} # <update with postgres name container>



echo "Creating all ehr datafactory database. Deleting existing ehr databases..."
# create mipmap database
echo "Creating $db_mipmap database"
docker exec -it $container_name psql -U {{ postgresql_user}} -d postgres -c "DROP DATABASE IF EXISTS $db_mipmap;"
docker exec -it $container_name psql -U {{ postgresql_user }} -d postgres -c "CREATE DATABASE $db_mipmap;"
# create and set up capture database
echo "Creating $db_capture database"
docker exec -it $container_name psql -U {{ postgresql_user }} -d postgres -c "DROP DATABASE IF EXISTS $db_capture;"
docker exec -it $container_name psql -U {{ postgresql_user }} -d postgres -c "CREATE DATABASE $db_capture;"

# create and set up harmonized database
echo "Creating $db_harmonized database"
docker exec -it $container_name psql -U {{ postgresql_user }} -d postgres -c "DROP DATABASE IF EXISTS $db_harmonized;"
docker exec -it $container_name psql -U {{ postgresql_user }} -d postgres -c "CREATE DATABASE $db_harmonized;"
